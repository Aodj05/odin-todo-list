new class{Controller(t,e){this.model=t,this.view=e,this.model.bindTodoListChange(this.onTodoListChange),this.view.bindAddTodo(this.handleAddTodo),this.view.bindEditTodo(this.handleEditTodo),this.view.bindDeleteTodo(this.handleDeleteTodo),this.view.bindToggleTodo(this.handleToggleTodo),this.onTodoListChange(this.model.todos)}onTodoListChange=t=>{this.view.displayTodos(t)};handleAddTodo=t=>{this.model.addTodo(t)};handleEditTodo=(t,e)=>{this.model.editTodo(t,e)};handleDeleteTodo=t=>{this.model.deleteTodo(t)};handleToggleTodo=t=>{this.model.toggleTodo(t)}}(new class{constructor(){this.todos=JSON.parse(localStorage.getItem("todos"))||[]}bindTodoListChange(t){this.onTodoListChange=t}_commit(t){this.onTodoListChange(t),localStorage.setItem("todos",JSON.stringify(t))}addTodo(t){const e={id:this.todos.length>0?this.todos[this.todos.length-1].id+1:1,text:t,complete:!1};this.todos.push(e),this._commit(this.todos)}editTodo(t,e){this.todos=this.todos.map((o=>o.id===t?{id:o.id,text:e,complete:o.complete}:o)),this._commit(this.todos)}deleteTodo(t){this.todos=this.todos.filter((e=>e.id!==t)),this._commit(this.todos)}toggleTodo(t){this.todos=this.todos.map((e=>e.id===t?{id:e.id,text:e.text,completr:!e.complete}:e)),this._commit(this.todos)}},new class{constructor(){this.app=this.getElement("#content"),this.form=this.createElement("form"),this.input=this.createElement("input"),this.input.type="text",this.input.placeholder="Add a todo",this.input.name="todo",this.submitButton=this.createElement("button"),this.submitButton.textContent="Submit",this.form.append(this.input,this.submitButton),this.title=this.createElement("h1"),this.title.textContent="To-dos",this.todoList=this.createElement("ul","todo-list"),this.app.append(this.title,this.form,this.todoList),this._tempTodoText="",this._initLocalListeners()}get _todoText(){return this.input.value}_resetInput(){this.input.value=""}createElement(t,e){const o=document.createElement(t);return e&&o.classList.add(e),o}getElement(t){return document.querySelector(t)}displayTodos(t){for(;this.todoList.firstChild;)this.todoList.removeChild(this.todoList.firstChild);if(0===t.length){const t=this.createElement("p");t.textContent="Nothing on list. Add something?",this.todoList.append(t)}else t.forEach((t=>{const e=this.createElement("li");e.id=t.id;const o=this.createElement("input");o.type="checkbox",o.checked=t.complete;const i=this.createElement("span");if(i.contentEditable=!0,i.classList.add("editable"),t.complete){const e=this.createElement("s");e.textContent=t.text,i.append(e)}else i.textContent=t.text;const s=this.createElement("button","delete");s.textContent="Delete",e.appened(o,i,s),this.todoList.append(e)}));console.log(t)}_initLocalListeners(){this.todoList.addEventListener("input",(t=>{"editable"===t.target.className&&(this._tempTodoText=t.target.innerText)}))}bindAddTodo(t){this.form.addEventListener("submit",(e=>{e.preventDefault(),this._todoText&&(t(this._todoText),this._resetInput())}))}bindDeleteTodo(t){this.todoList.addEventListener("click",(e=>{if("delete"===e.target.className){const o=parseInt(e.target.parentElement.id);t(o)}}))}bindEditTodo(t){this.todoList.addEventListener("focusout",(e=>{if(this._tempTodoText){const o=parseInt(e.target.parentElement.id);t(o,this._tempTodoText),this._tempTodoText=""}}))}bindToggleTodo(t){this.todoList.addEventListener("change",(e=>{if("checkbox"===e.target.type){const o=parseInt(e.target.parentElement.id);t(o)}}))}});